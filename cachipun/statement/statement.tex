\documentclass{oci}
\usepackage[utf8]{inputenc}
\usepackage{lipsum}

\title{Ca-chi-pún}
\codename{cachipun}

\begin{document}
\begin{problemDescription}
  Cada año la Organización de Cachipún Internacional (OCI) organiza la
  más famosa y conocida convención de cachipún, la cachi-con.
  En esta, profesionales y aficionados de todo el mundo se reúnen durante una
  semana con el solo fin de disfrutar del popular juego.
  Durante la convención se llevan a cabo muchos eventos, pero sin duda una de
  las atracciones más populares son las partidas masivas de cachipún.

  En una partida masiva de cachipún se enfrentan de forma simultánea $J$
  jugadores quienes deben gritar al unísono ca - chi - pún.
  Como es habitual, luego del grito, cada jugador debe escoger entre sacar
  piedra, papel o tijera y demostrar su elección representando con la mano
  el objeto escogido.
  Evidentemente el papel vence a la piedra pues la envuelve, la piedra vence a
  las tijeras puesto que las aplasta y la tijera vence al papel pues lo corta.

  Al ser una atracción tan popular, la cantidad de jugadores que se reúne en una
  sola partida puede ser gigantesca y siempre es difícil determinar el
  resultado final de esta.
  Para realizar esta difícil tarea se designan jueces externos quiénes
  están encargados de observar una cierta cantidad de jugadores.
  Al finalizar la partida los jueces reportan sus observaciones al juez
  principal quien tiene la responsabilidad de calcular el resultado final a
  partir de todas las observaciones.

  Con el fin de evitar que los jueces tengan que memorizar tanta información,
  solo se les pide recordar observaciones que involucren a dos jugadores.
  Adicionalmente solo deberán recordar quién de los dos jugadores fue el ganador
  o si hubo un empate entre ellos.
  Por ejemplo, un juez puede recordar que el jugador $a$ perdió contra el
  jugador $b$ o que el jugador $c$ empató con el $d$, pero no saber de forma
  exacta que objeto (piedra, papel o tijera) escogió cada jugador.

  El juez principal sigue una estrategia sencilla para reunir la información del
  resto de los jueces.
  Cada juez indica una a una las observaciones que recuerda y el juez principal
  las agrega en ese mismo orden a la información que lleva acumulada.
  Sin embargo, suele suceder que los jueces realizan observaciones con recuerdos
  erróneos, así que el juez principal debe asegurarse que en cada momento la
  información acumulada sea consistente.

  Diremos que la información acumulada es consistente si existe una forma de
  asignar un objeto a cada jugador manteniendo verdadera la información
  acumulada.
  De forma análoga diremos que la información acumulada es inconsistente si no
  existe una forma de asignar objetos a cada jugador manteniendo verdadera la
  información acumulada.
  Por ejemplo, la información mostrada a continuación es consistente pues es
  posible que el jugador 1 haya sacado piedra y tanto el jugador 2 como
  el 3 hayan sacado tijeras.

    \begin{center}
      El jugador 1 le ganó al 2.\\
      El jugador 3 perdió contra el jugador 1.\\
      El jugador 3 empató con el 2.
    \end{center}

  Si en algún momento el juez principal recibe una observación que al agregarse
  deja la información en un estado inconsistente entonces la descartará y
  seguirá procesando el resto de las observaciones.
  Por ejemplo, dada la información anterior, si el juez principal recibe una
  observación diciendo que el jugador 1 empató con el 2 la descartará, pues
  no existe manera de asignar objetos a los jugadores 1 y 2 de forma que 1 le
  haya ganado a 2 y a la vez hayan empatado.

  Los organizadores de la cachi-con están preocupados de que se estén
  descartando demasiadas observaciones.
  Tu tarea es determinar cuantas observaciones fueron descartadas para una
  partida de cachipún masiva dada la lista de observaciones procesadas por el
  juez principal.
\end{problemDescription}

\begin{inputDescription}
  La primera línea de la entrada contiene dos enteros positivos $J$ y $Q$
  indicando respectivamente la cantidad de jugadores y observaciones procesadas
  por el juez principal.
  Cada jugador es identificado con un número entre 1 y $J$.
  Posteriormente, cada una de las siguientes $Q$ líneas contiene la descripción
  de una observación en el orden procesadas por el juez principal.
  Cada observación es descrita con tres enteros $a$, $b$ y $m$.
  Los enteros $a$ y $b$ ($a\neq b$ y $1\leq a, b \leq J$) indican los jugadores
  involucrados en la observación. 
  El entero $m$ puede ser 0, 1 o 2 indicando respectivamente si la observación indica
  que $a$ perdió, empató o ganó contra $b$.
\end{inputDescription}

\begin{outputDescription}
  La salida debe contener un único entero indicando la cantidad de observaciones
  que fueron descartadas, es decir, la cantidad de observación que de haber sido
  agregadas hubiesen dejado la información en un estado inconsistente.
\end{outputDescription}

\begin{scoreDescription}
  \score{10} Se probarán varios casos donde $J=2$ y $0 < Q < 10$.
  \score{15} Se probarán varios casos donde $J=3$ y $0 < Q < 10$.
  \score{32} Se probarán varios casos donde $0 < J \leq 10^5$ y $0 < Q < 10$.
  \score{43} Se probarán varios casos donde $0 < J \leq 10^5$ y $0 < Q \leq 10^5$
\end{scoreDescription}

\begin{sampleDescription}
\sampleIO{sample-1}
\sampleIO{sample-2}
\end{sampleDescription}

\end{document}
